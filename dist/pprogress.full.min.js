/*!
 * pprogress - Pie style progress inidcator
 * v0.1.1
 * https://github.com/firstandthird/pprogress
 * copyright First + Third 2013
 * MIT License
*/
!function(a,b){var c=0,d=function(a){this.obj=a};d.prototype.__init=function(a){b.extend(this,this.obj),this.id=c++,this.obj.defaults=this.obj.defaults||{},b.extend(this,this.obj.defaults,a),b("body").trigger("FidelPreInit",this),this.setElement(this.el||b("<div/>")),this.init&&this.init(),b("body").trigger("FidelPostInit",this)},d.prototype.eventSplitter=/^(\w+)\s*(.*)$/,d.prototype.setElement=function(a){this.el=a,this.getElements(),this.delegateEvents(),this.dataElements(),this.delegateActions()},d.prototype.find=function(a){return this.el.find(a)},d.prototype.proxy=function(a){return b.proxy(a,this)},d.prototype.getElements=function(){if(this.elements)for(var a in this.elements){var b=this.elements[a];this[b]=this.find(a)}},d.prototype.dataElements=function(){var a=this;this.find("[data-element]").each(function(c,d){var e=b(d),f=e.data("element");a[f]=e})},d.prototype.delegateEvents=function(){if(this.events)for(var a in this.events){var b=this.events[a],c=a.match(this.eventSplitter),d=c[1],e=c[2],f=this.proxy(this[b]);""===e?this.el.on(d,f):this[e]&&"function"!=typeof this[e]?this[e].on(d,f):this.el.on(d,e,f)}},d.prototype.delegateActions=function(){var a=this;a.el.on("click","[data-action]",function(c){var d=b(this),e=d.attr("data-action");a[e]&&a[e](c,d)})},d.prototype.on=function(a,b){this.el.on(a+".fidel"+this.id,b)},d.prototype.one=function(a,b){this.el.one(a+".fidel"+this.id,b)},d.prototype.emit=function(a,b,c){var d=c?".fidel"+this.id:"";this.el.trigger(a+d,b)},d.prototype.hide=function(){if(this.views)for(var a in this.views)this.views[a].hide();this.el.hide()},d.prototype.show=function(){if(this.views)for(var a in this.views)this.views[a].show();this.el.show()},d.prototype.destroy=function(){this.el.empty(),this.emit("destroy"),this.el.unbind(".fidel"+this.id)},d.declare=function(a){var b=function(a,b){this.__init(a,b)};return b.prototype=new d(a),b},d.onPreInit=function(a){b("body").on("FidelPreInit",function(b,c){a.call(c)})},d.onPostInit=function(a){b("body").on("FidelPostInit",function(b,c){a.call(c)})},a.Fidel=d}(window,window.jQuery||window.Zepto),function(a){a.declare=function(b,c){a.fn[b]=function(){var d,e,f=Array.prototype.slice.call(arguments),g=f.shift();return e=this.each(function(){var e=a(this),h=e.data(b);if(!h){var i=Fidel.declare(c),j=a.extend({},g,{el:e});h=new i(j),e.data(b,h)}"string"==typeof g&&(d=h[g].apply(h,f))}),"undefined"!=typeof d?d:e},a.fn[b].defaults=c.defaults||{}},a.Fidel=window.Fidel}(jQuery),function(a){var b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;a.declare("pprogress",{defaults:{width:100,fillColor:"rgba(0,0,0,0.25)",speed:500,rate:.02,cap:.9,ease:function(a,b,c,d){return c*a/d+b}},init:function(){this.lineWidth=.05*this.width,this.lineWidthOut=this.lineWidth,this.started=!1,this.currentPercent=0,this.percentComplete=0,this.outerRingWidth=0,this.canvas=a("<canvas></canvas>"),this.canvas.attr("height",this.width),this.canvas.attr("width",this.width),this.canvas.css({height:this.width,width:this.width}),this.el.html(this.canvas),this.context=this.canvas[0].getContext("2d"),this.context.fillStyle=this.fillColor,this.context.fillRect(0,0,this.width,this.width)},start:function(a){var c=this;if(b(this.proxy(this.updateProgress)),!a)var d=setInterval(function(){c.currentPercent>=c.cap&&clearInterval(d),c.inc()},this.speed)},drawArc:function(a,b,c,d,e,f){1!==e&&0!==e&&(e=1-e),this.context.beginPath(),f&&this.context.moveTo(this.width/2,this.width/2),this.context.arc(a,b,c,1.5*Math.PI-360*e*(Math.PI/180),3*Math.PI/2,!0),f?(this.context.fillStyle="rgba(0,0,0,1)",this.context.fill()):(this.context.lineWidth=d,this.context.stroke())},updateProgress:function(){if(this.currentPercent>=.99)return this.animateOut(),void 0;this.started||this.emit("start");var a=new Date;this.context.clearRect(0,0,this.width,this.width),this.context.globalCompositeOperation="source-over",this.context.fillStyle=this.fillColor,this.context.fillRect(0,0,this.width,this.width),this.context.globalCompositeOperation="destination-out",this.outerRingWidth=this.ease(a.getMilliseconds(),this.outerRingWidth,(this.width-2*this.lineWidth)/2-this.outerRingWidth,2e3),this.drawArc(this.width/2,this.width/2,this.outerRingWidth,this.lineWidth,1),this.currentPercent=this.ease(a.getMilliseconds(),this.currentPercent,this.percentComplete-this.currentPercent,1e3),this.drawArc(this.width/2,this.width/2,this.outerRingWidth,0,this.currentPercent,!0),this.started=!0,b(this.proxy(this.updateProgress))},animateOut:function(){if(this.context.clearRect(0,0,this.width,this.width),Math.ceil(this.lineWidthOut)>=this.width/2)return this.emit("complete"),void 0;var a=new Date;this.context.globalCompositeOperation="source-over",this.context.fillStyle=this.fillColor,this.context.fillRect(0,0,this.width,this.width),this.context.globalCompositeOperation="destination-out",this.lineWidthOut=this.ease(a.getMilliseconds(),this.lineWidthOut,this.width/2-this.lineWidthOut,2e3),this.drawArc(this.width/2,this.width/2,this.outerRingWidth,this.lineWidthOut,1),this.context.beginPath(),this.context.arc(this.width/2,this.width/2,this.outerRingWidth,2*Math.PI,0,!0),this.context.closePath(),this.context.fillStyle="rgba(0,0,0,1)",this.context.fill(),b(this.proxy(this.animateOut))},set:function(a){this.percentComplete=a,this.percentComplete>1&&(this.percentComplete=1),this.percentComplete<0&&(this.percentComplete=0)},tick:function(a){this.percentComplete+=a,this.percentComplete>1&&(this.percentComplete=1),this.percentComplete<0&&(this.percentComplete=0)},inc:function(){this.tick(Math.random()*this.rate)},done:function(){this.set(1)}})}(jQuery);